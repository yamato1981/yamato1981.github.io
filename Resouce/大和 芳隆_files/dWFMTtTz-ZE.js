if (self.CavalryLogger) { CavalryLogger.start_js(["D2T2D"]); }

__d('CollectionsAddNewHub',['AsyncRequest','AsyncResponse','Event','Form','Keys','ProfileOverviewSection'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={init:function i(j,k,l,m,n){c('ProfileOverviewSection').callWithSection(m,function(o){this.initImpl(j,k,l,m,n,o.getNode());}.bind(this));},initImpl:function i(j,k,l,m,n,o){if(!j)return;var p=j.getCore();j.subscribe('select',function(r,s){if(!s.selected.type.match('addnew'))return;this.createHub(j,s.selected.orig_text||s.selected.text,k,l,m,n,o);}.bind(this));var q=j.getView();c('Event').listen(p.getElement(),'keydown',function(event){if(c('Event').getKeyCode(event)==c('Keys').RETURN&&!q.getSelection()){this.createHub(j,p.getValue(),k,l,m,n,o);event.kill();}}.bind(this));},createHub:function i(j,k,l,m,n,o,p){var q=j.getCore();q.setEnabled(false);var r=function t(){q.reset();q.getElement().blur();q.setEnabled(true);},s=babelHelpers['extends']({title:k,type:l,root_id:p.id,results:j.getData().buildQueryResults(k)},c('Form').serialize(o));new (c('AsyncRequest'))(m).setData(s).setHandler(r).setErrorHandler(function(t){r();c('AsyncResponse').defaultErrorHandler(t);}).send();}};f.exports=h;}),null);
__d('OGAggregationBling',['cx','fbt','React','NumberFormat'],(function a(b,c,d,e,f,g,h,i){var j,k;if(c.__markCompiled)c.__markCompiled();j=babelHelpers.inherits(l,c('React').Component);k=j&&j.prototype;l.prototype.render=function(){'use strict';var m=[];if(this.props.likes)m.push(c('React').createElement('span',{className:"_14a_",key:'likes'},c('React').createElement('i',{className:"_4fx"}),c('React').createElement('span',null,c('NumberFormat').formatIntegerWithDelimiter(this.props.likes,this.props.numberDelimiter)),c('React').createElement('span',{className:'accessible_elem'},i._("\u3044\u3044\u306d\uff01"))));if(this.props.comments){m.push(c('React').createElement('span',{className:"_14a_",key:'comments'},c('React').createElement('i',{className:"_4fy"}),c('React').createElement('span',null,c('NumberFormat').formatIntegerWithDelimiter(this.props.comments,this.props.numberDelimiter)),c('React').createElement('span',{className:'accessible_elem'},i._("\u30b3\u30e1\u30f3\u30c8"))));}else{var n=!(this.props.mini&&this.props.likes),o=!this.props.likes&&this.props.alwaysVisible,p="_14a_"+(n?' '+"_4fz":'')+(o?' '+"_55n8":'');m.push(c('React').createElement('span',{className:p,key:'comments'},c('React').createElement('i',{className:"_4fy"})));}return (c('React').createElement('a',{className:"_4f-",href:'#',rel:'toggle'},m));};function l(){'use strict';j.apply(this,arguments);}f.exports=l;}),null);
__d('OGAggregationUFI',['csx','cx','DOM','CSS','OGAggregationBling','React','ReactDOM','UFICentralUpdates','UFIToplevelPagedCommentList','UFIConstants','UFIFeedbackTargets','UFILikeLink.react','UFIReactionTypes','UFIUserActions'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l,m){this._root=k;this._id=l.ftentidentifier;this._source=l.source;this._numberDelimiter=l.numberdelimiter||',';this._mini=l.mini;this._alwaysVisible=l.alwaysvisible;this._bling=c('DOM').scry(this._root,"._4f-")[0];this._initializeLikeLink();c('UFICentralUpdates').handleUpdate(c('UFIConstants').UFIPayloadSourceType.INITIAL_SERVER,m);c('UFICentralUpdates').subscribe('feedback-updated',function(n,o){if(this._id in o.updates)this.render();}.bind(this));this.render();}Object.assign(j.prototype,{_initializeLikeLink:function k(){if(this._likeLink)throw new Error('OGAggregationUFI attempted to initialize the like link when the like'+' link was already present');var l=c('DOM').scry(this._root,'.like_link')[0];if(l){var m=document.createElement('span');l.parentNode.replaceChild(m,l);this._likeLink=m;m.appendChild(l);}},render:function k(){c('UFIFeedbackTargets').getFeedbackTarget(this._id,function(l){if(this._likeLink){var m=!l.hasviewerliked,n=function(event){c('UFIUserActions').changeReaction(this._id,m?c('UFIReactionTypes').LIKE:c('UFIReactionTypes').NONE,{source:this._source,target:event.target});}.bind(this),o=c('React').createElement(c('UFILikeLink.react'),{onClick:n,likeAction:m});c('ReactDOM').render(o,this._likeLink);}if(this._bling){var p=c('UFIToplevelPagedCommentList').getDisplayedCommentCountForFeedbackTargetID_UNSAFE(this._id);c('CSS').conditionClass(this._root,"_93n",this._mini&&(l.likecount||p));var q=c('React').createElement(c('OGAggregationBling'),{alwaysVisible:this._alwaysVisible,mini:this._mini,likes:l.likecount,comments:p,numberDelimiter:this._numberDelimiter});c('ReactDOM').render(q,this._bling);}}.bind(this));}});f.exports=j;}),null);
__d('OGCollectionItemRatingControl',['AsyncRequest'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={registerStars:function i(j,k,l){j.onClick(function(m){new (c('AsyncRequest'))().setURI(l).setRelativeTo(k).setData({stars:m}).send();return false;});}};f.exports=h;}),null);
__d('PageStars',['Event','Locale','Style'],(function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h=5;function i(j,k,l,m,n,o,p,q){this.myRating=n;this.avgRating=m;this.avgStars=k;this.myStars=l;this.margin=q;this.width=o;this.height=p;for(var r=0;r<j.length;r++){var s=j[r],t=r+1;for(var u=0;u<s.length;u++){if(!s[u])continue;c('Event').listen(s[u],'mouseenter',this._hover.bind(this,t));c('Event').listen(s[u],'mouseleave',this._mouseout.bind(this,t));c('Event').listen(s[u],'click',this._click.bind(this,t));}}}Object.assign(i.prototype,{onClick:function j(k){this.callback=k;},_updateUI:function j(){if(this.hovered||this.myRating){this.avgStars&&this._setClip(this.avgStars,0);this.myStars&&this._setClip(this.myStars,this.hovered||this.myRating);}else{this.myStars&&this._setClip(this.myStars,0);this.avgStars&&this._setClip(this.avgStars,this.avgRating||0);}},_setClip:function j(k,l){var m=Math.round(l*this.width+Math.floor(l)*this.margin),n=0;if(c('Locale').isRTL()){n=Math.round((h-l)*this.width+Math.floor(h-l)*this.margin);m+=n;}var o='rect(0px, '+m+'px, '+this.height+'px, '+n+'px)';c('Style').set(k,'clip',o);},_click:function j(k){this.myRating=k;this._updateUI();return this.callback&&this.callback(k);},_hover:function j(k){this.hovered=k;this._updateUI();},_mouseout:function j(k){if(this.hovered===k){this.hovered=null;this._updateUI();}},setAverageRating:function j(k){this.avgRating=k;this._updateUI();},setMyRating:function j(k){this.myRating=k;this._updateUI();}});f.exports=i;}),null);
__d('TimelineCollectionItemReorder',['csx','cx','AsyncRequest','DataStore','DOMQuery','OGCollectionAddObject','Parent','SortableGroup','TimelineAppCollection','$'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();var j='item-reorder-inst';function k(m,n){'use strict';this._collectionToken=n;this._initSorting();c('DataStore').set(c('$')(m),j,this);c('TimelineAppCollection').subscribe(c('TimelineAppCollection').NEW_ITEM,this._processNewItem.bind(this,m));c('OGCollectionAddObject').subscribe(c('OGCollectionAddObject').NEW_ITEM,this._processNewItem.bind(this,m));}k.prototype._initSorting=function(){'use strict';this._sortableGroup=new (c('SortableGroup'))().setDropCallback(function(m,n){new (c('AsyncRequest'))('/ajax/timeline/collections/reorder_items/').setData({order:this._sortableGroup.getOrder(),collection_token:this._collectionToken}).send();}.bind(this));};k.prototype._registerCollectionItems=function(m){'use strict';var n=c('DOMQuery').scry(m,'li[data-sort-id]');n.forEach(function(o){this._registerCollectionItem(o);},this);};k.prototype._registerCollectionItem=function(m){'use strict';var n=m.getAttribute('data-sort-id');this._sortableGroup.removeSortable(n);setTimeout(this._sortableGroup.addSortable.bind(this._sortableGroup,n,m),500);};k.prototype._processNewItem=function(m,n,o){'use strict';var p=c('Parent').bySelector(o.grid,"._30f");if(m!=p.id)return;this._registerCollectionItem(o.newItem);};k.registerCollectionItems=function(m,n,o){'use strict';var p=l(m,n);if(p)p._registerCollectionItems(o);};function l(m,n){var o=c('DataStore').get(c('$')(m),j);return o||new k(m,n);}f.exports=k;}),null);
__d('TimelineInHouseOGCurationControl',['csx','cx','CSS','DOM','Parent','TimelineAppCollection'],(function a(b,c,d,e,f,g,h,i){if(c.__markCompiled)c.__markCompiled();function j(k,l,m,n){this._menu=k;this._collectionToken=l;this._popoverMenu=m;this._placeholderMarkup=n;this._menu.subscribe('itemclick',function(o,p){var q=p.item.getValue(),r='add_to_top',s='remove_from_top';if(q=="delete"||q=="recommend")return;if(q==l){p.item.deselect();k.done();return;}var t=c('Parent').bySelector(this._popoverMenu,"._3owb");if(q=='highlight'){var u=c('DOM').scry(t,"._54_4");if(u[0])if(!p.item.isSelected()){c('CSS').addClass(u[0],'selected');}else c('CSS').removeClass(u[0],'selected');k.done();return;}else if(q&&q.substring(0,r.length)===r){c('TimelineAppCollection').addPlaceholderToCollection(q.substring(r.length+1),t.parentNode);k.done();return;}else if(q&&q.substring(0,s.length)===s){var v=q.substring(s.length+1);if(l!==v){c('TimelineAppCollection').decrementCount(c('TimelineAppCollection').getIDByToken(v));k.done();return;}}t.appendChild(n);c('CSS').hide(c('DOM').find(t,'[data-collection-item-bg]'));c('CSS').hide(c('DOM').find(t,'[data-collection-item-priv]'));if(!q){k.done();return;}c('TimelineAppCollection').decrementCount(c('TimelineAppCollection').getIDByToken(l));if(q.substring(0,15)!=s)c('TimelineAppCollection').addPlaceholderToCollection(q,t.parentNode);k.done();}.bind(this));}f.exports=j;}),null);